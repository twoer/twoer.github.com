/* EC table */ 
var ECCNList={};var ECCNConstants={};var ECCN=function(formid){var Me=this;ECCNList[formid]=Me;this.id=formid;this.doPrep=true;this.isDebug=false;this.doPrepPrev=true;this.prepState={next:0,prev:0};this.prepPage={next:0,prev:0};this.prepareaName={};this.pageFieldName=this.id+"_p";this.totalPagesFieldName=this.id+"_totalpages";this.totalRowsFieldName=this.id+"_totalrows";this.prepareaName.next=this.id+"_ec_preparea_n";this.prepareaName.prev=this.id+"_ec_preparea_p";Me.buildPrepArea=function(){var ta=document.createElement("textarea");ta.id=this.prepareaName.next;ta.disabled=true;ta.style.display="none";document.body.appendChild(ta);var tb=document.createElement("textarea");tb.id=this.prepareaName.prev;tb.disabled=true;tb.style.display="none";document.body.appendChild(tb);if(Me.isDebug){ta.disabled=false;ta.style.display="inline";ta.rows=10;ta.cols=50;tb.disabled=false;tb.style.display="inline";tb.rows=10;tb.cols=50}};Me.goPage=function(){var newPageNO=$(Me.pageFieldName).value;var key=null;if(newPageNO==Me.prepPage.next&&Me.prepState.next==2){key="next"}else{if(newPageNO==Me.prepPage.prev&&Me.prepState.prev==2&&Me.doPrepPrev){key="prev"}}if(key!=null){try{var newhtml=$(Me.prepareaName[key]).value;if(newhtml==""){$(Me.id).submit();return}$(Me.id).innerHTML=newhtml;Me.prepState[key]=0;window.setTimeout(Me.ajaxPrepSubmit,10)}catch(ex){$(Me.pageFieldName).value=newPageNO;Me.ajaxSubmit()}}else{Me.ajaxSubmit()}};Me.dealResponse={next:function(originalRequest){$(Me.prepareaName.next).value=Me.cutText(originalRequest.responseText);Me.prepState.next=2;Me.doingAjaxSubmit=false},prev:function(originalRequest){$(Me.prepareaName.prev).value=Me.cutText(originalRequest.responseText);Me.prepState.prev=2;Me.doingAjaxSubmit=false}};Me.cutText=function(text){eval('var rex= /<form.+id="?'+Me.id+'"?[^>]*>/im ;');var mtext=text.match(rex);if(mtext==null){return""}text=text.substr(mtext.index+mtext[0].length);var end=text.indexOf("</form>");return text.substring(0,end)};Me.ajaxPrepSubmit=function(){if(!Me.doPrep){return}try{Me.ajaxPrep(1);Me.ajaxPrep(-1)}catch(e){}};Me.ajaxPrep=function(which){var key;if(which==1){key="next"}else{if(which==-1&&Me.doPrepPrev){key="prev"}else{return}}Me.prepState[key]=1;Me.prepPage[key]=$(Me.pageFieldName).value/1+which;if(Me.prepPage[key]<1||Me.prepPage[key]>($(Me.totalPagesFieldName).value/1)){return}$(Me.pageFieldName).value=Me.prepPage[key];Me.ajaxSubmit(Me.dealResponse[key],true);$(Me.pageFieldName).value=Me.prepPage[key]-which};Me.init=function(){Me.buildPrepArea();Me.ajaxPrepSubmit()};Me.doingAjaxSubmit=false;Me.ajaxSubmit=function(resfunc,asy){if($("ajaxWaitng")){$("ajaxWaitng").style.visibility="visible"}if(!asy){asy=false}if(!resfunc){resfunc=Me.fillForm}if(!asy&&Me.doingAjaxSubmit){}Me.doingAjaxSubmit=true;Ajax.formSubmit(Me.id,resfunc,"post",asy)};Me.fillForm=function(originalRequest){var newhtml=Me.cutText(originalRequest.responseText);if(newhtml==""){return}$(Me.id).innerHTML=newhtml;Me.init();Me.doingAjaxSubmit=false;if($("ajaxWaitng")){$("ajaxWaitng").style.visibility="hidden"}}};var EccnUtil={};EccnUtil.hideOrShowCol=function(a){var b=a.id+"_c";col=$(b);if(col.style.display=="none"){col.style.display="block";col.setAttribute("width",a.getAttribute("ow"))}else{col.style.display="none";a.setAttribute("ow",col.getAttribute("width"));col.setAttribute("width","0")}};EccnUtil.noExport=function(c,a){if(!a){a="eti"}var b=document.getElementById(c);try{b[a].value=""}catch(d){}};EccnUtil.refresh=function(b){var a=document.getElementById(b);try{a[b+"_totalrows"].value=""}catch(c){}};EccnUtil.gotoPage=function(h,d,a,c,k,j){var b=document.getElementById(h);b.setAttribute("action",d);b.setAttribute("method",a);b[c].value=j;EccnUtil.noExport(h,k);try{if(ECCNList[h].doPrep){ECCNList[h].goPage()}else{ECCNList[h].ajaxSubmit()}}catch(f){try{ECCNList[h].ajaxSubmit()}catch(g){b.submit()}}};EccnUtil.gotoPageByInput=function(h,d,a,c,l,g){var b=document.getElementById(h);var f="跳转页数只能是 1 至";if(typeof I18nMsgConfig!="undefined"&&I18nMsgConfig.ecJumpBeforPart){f=I18nMsgConfig.ecJumpBeforPart}var e=" 的整数。";if(typeof I18nMsgConfig!="undefined"&&I18nMsgConfig.ecJumpAfterPart){e=I18nMsgConfig.ecJumpAfterPart}var k=b[g].value/1;var j=b[h+"_totalpages"].value/1;if(!isFinite(k)||(k+"").indexOf(".")!=-1||k<1||k>j){alert(f+j+" "+e);b[g].focus();b[g].select();return}if(k<1){k=1}EccnUtil.gotoPage(h,d,a,c,l,k)};EccnUtil.doExportList=function(d,f){var c=document.getElementById(d).getAttribute("action");var e="post";var a="eti";var b="xls";EccnUtil.doExport(d,c,e,a,b,f)};EccnUtil.doExport=function(e,d,g,a,b,f){var c=document.getElementById(e);c[e+"_ev"].value=b;c[e+"_efn"].value=f;c[a].value=e;c.setAttribute("action",d);c.setAttribute("method",g);c.submit()};EccnUtil.changeRowsDisplayed=function(g,e,a,d,j,h){var b=document.getElementById(g);var c=h.options[h.selectedIndex].value;if(c>100){if(!confirm("Warning:当显示条目数量过大时，会导致页面加载速度变慢，请确认是否更改？")){return}}b[g+"_crd"].value=h.options[h.selectedIndex].value;b[d].value="1";b.setAttribute("action",e);b.setAttribute("method",a);EccnUtil.noExport(g,j);try{ECCNList[g].ajaxSubmit()}catch(f){b.submit()}};EccnUtil.checkAll=function(c,a,d){var b=document.getElementById(c);for(i=0;i<b.elements.item(a).length;i++){if(b.elements.item(a).item(i).disabled==false){b.elements.item(a).item(i).checked=b.elements.item(d).checked}}};EccnUtil.checkAll2=function(a){var b=$(":checkbox[batchDelete='true']").each(function(){$(this).prop("checked",a.checked)})};$(function(){var j=$(".eXtremeTable");var f=j.find("> table:first");var g=j.find("> table:last");var h=j.find("thead .filter");var k=function(){if(f.outerWidth(true)>j.outerWidth(true)){g.css("width",f.outerWidth(true))}else{g.css("width","100%")}};$(window).resize(function(){k()});k()});
